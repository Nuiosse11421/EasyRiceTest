{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 107, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Work/Code/Project/RiceInspectionApp/frontend/src/pages/history.js"],"sourcesContent":["// pages/history.js\r\nimport { useState, useEffect } from 'react';\r\nimport { useRouter } from 'next/router';\r\nimport axios from 'axios';\r\nimport Link from 'next/link';\r\nimport '../app/globals.css'\r\n\r\n\r\nconst HistoryPage = () => {\r\n    const router = useRouter();\r\n    const [history, setHistory] = useState([]);\r\n    const [totalPages, setTotalPages] = useState(1);\r\n    const [page, setPage] = useState(1);\r\n    const [searchId, setSearchId] = useState('');\r\n    const [fromDate, setFromDate] = useState('');\r\n    const [toDate, setToDate] = useState('');\r\n    const [selectedItems, setSelectedItems] = useState([]);\r\n\r\n    // ดึงข้อมูล history\r\n    const fetchHistory = async () => {\r\n        try {\r\n            const res = await axios.get(`http://localhost:8000/history`, {\r\n                params: { page, searchId, formDate: fromDate, toDate }\r\n            });\r\n            setHistory(res.data.history);\r\n            setTotalPages(res.data.totalPages);\r\n        } catch (error) {\r\n            console.error('Error fetching history:', error);\r\n        }\r\n    };\r\n\r\n    // เรียกใช้เมื่อหน้าต่างโหลดหรือมีการเปลี่ยนแปลงข้อมูล\r\n    useEffect(() => {\r\n        fetchHistory();\r\n    }, [page, searchId, fromDate, toDate]);\r\n\r\n    const handleSearch = () => {\r\n        setPage(1); // รีเซ็ตไปยังหน้าที่ 1 เมื่อมีการค้นหาใหม่\r\n        fetchHistory();\r\n    };\r\n    const handleCheckboxChange = (inspectionId) => {\r\n        setSelectedItems((prevSelected) =>\r\n            prevSelected.includes(inspectionId)\r\n                ? prevSelected.filter((id) => id !== inspectionId)\r\n                : [...prevSelected, inspectionId]\r\n        );\r\n    };\r\n    const handleClear = () => {\r\n        setSearchId('');\r\n        setFromDate('');\r\n        setToDate('');\r\n        setPage(1);\r\n        fetchHistory();\r\n    };\r\n\r\n    const handleRowClick = (inspectionId) => {\r\n        router.push(`/result/${inspectionId}`);\r\n    };\r\n    const handleDelete = async () => {\r\n        try {\r\n            await Promise.all(\r\n                selectedItems.map((inspectionID) => axios.delete(`http://localhost:8000/history/${inspectionID}`))\r\n            );\r\n            setSelectedItems([]);\r\n            fetchHistory();\r\n        } catch (err) {\r\n            console.error('Error delete items: ', err.message)\r\n        }\r\n    }\r\n\r\n    return (\r\n        <div className='bg-gray-100 p-8 text-black'>\r\n            <div className=\"bg-gray-100 p-8 text-black max-w-[1332px] h-auto mx-auto\">\r\n                <div className=\"flex justify-end space-x-2 mb-4\">\r\n                    <button className='bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded' onClick={() => router.push('/create-inspection')}>+ Create Inspection</button>\r\n                </div>\r\n                {/* Search Form */}\r\n                <div className=\"bg-white p-4 rounded-md shadow mb-4\">\r\n                    <div className=\"flex justify-between items-center mb-4\">\r\n                        <div className=\"flex space-x-4 w-full\">\r\n                            <div className=\"flex-1\">\r\n                                <label className=\"block font-semibold text-gray-700\">ID</label>\r\n                                <input\r\n                                    type=\"text\"\r\n                                    value={searchId}\r\n                                    onChange={(e) => setSearchId(e.target.value)}\r\n                                    placeholder=\"Search by Inspection ID\"\r\n                                    className=\"border border-gray-300 rounded-md w-full p-2 mt-1 focus:ring-green-500 focus:border-green-500\"\r\n                                />\r\n                            </div>\r\n                            <div className=\"flex-1\">\r\n                                <label className=\"block font-semibold text-gray-700\">From Date</label>\r\n                                <input\r\n                                    type=\"date\"\r\n                                    value={fromDate}\r\n                                    onChange={(e) => setFromDate(e.target.value)}\r\n                                    className=\"border border-gray-300 rounded-md w-full p-2 mt-1 focus:ring-green-500 focus:border-green-500\"\r\n                                />\r\n                            </div>\r\n                            <div className=\"flex-1\">\r\n                                <label className=\"block font-semibold text-gray-700\">To Date</label>\r\n                                <input\r\n                                    type=\"date\"\r\n                                    value={toDate}\r\n                                    onChange={(e) => setToDate(e.target.value)}\r\n                                    className=\"border border-gray-300 rounded-md w-full p-2 mt-1 focus:ring-green-500 focus:border-green-500\"\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"flex justify-between\">\r\n                        <button\r\n                            onClick={handleClear}\r\n                            className=\"bg-gray-300 hover:bg-gray-400 text-gray-700 font-semibold py-2 px-4 rounded\"\r\n                        >\r\n                            Clear Filter\r\n                        </button>\r\n                        <button\r\n                            onClick={handleSearch}\r\n                            className=\"bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded\"\r\n                        >\r\n                            Search\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n                <div className=\"flex items-center justify-between mb-4\">\r\n                    <button\r\n                        onClick={handleDelete}\r\n                        disabled={selectedItems.length === 0}\r\n                        className=\"bg-red-600 hover:bg-red-700 text-white font-semibold py-2 px-4 rounded disabled:opacity-50\"\r\n                    >\r\n                        Delete\r\n                    </button>\r\n                    <span className=\"text-gray-700\">Selection items: {selectedItems.length} item(s)</span>\r\n                </div>\r\n                {/* Table */}\r\n                <table className=\"w-full border border-gray-300 rounded-md shadow-md\">\r\n                    <thead className=\"bg-green-600 text-black\">\r\n                        <tr>\r\n                            <th></th>\r\n                            <th>Create Date - Time</th>\r\n                            <th>Inspection ID</th>\r\n                            <th>Name</th>\r\n                            <th>Standard</th>\r\n                            <th>Note</th>\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        {history.map((item) => (\r\n                            <tr key={item.inspectionID} className=\"border-t border-gray-300 hover:bg-gray-100\">\r\n                                <td className='p-2'>\r\n                                    <input\r\n                                        type=\"checkbox\"\r\n                                        checked={selectedItems.includes(item.inspectionID)}\r\n                                        onChange={() => handleCheckboxChange(item.inspectionID)}\r\n                                        className=\"focus:ring-green-500\"\r\n                                    />\r\n                                </td>\r\n                                <td className=\"p-2 cursor-pointer\" onClick={() => handleRowClick(item.inspectionID)}>{new Date(item.createDate).toLocaleString()}</td>\r\n                                <td className=\"p-2 cursor-pointer\" onClick={() => handleRowClick(item.inspectionID)}>{item.inspectionID}</td>\r\n                                <td className=\"p-2 cursor-pointer\" onClick={() => handleRowClick(item.inspectionID)}>{item.name}</td>\r\n                                <td className=\"p-2 cursor-pointer\" onClick={() => handleRowClick(item.inspectionID)}>{item.standardName}</td>\r\n                                <td className=\"p-2 cursor-pointer\" onClick={() => handleRowClick(item.inspectionID)}>{item.note}</td>\r\n                            </tr>\r\n                        ))}\r\n                    </tbody>\r\n                </table>\r\n\r\n                {/* Pagination */}\r\n                <div className='flex items-center justify-between mt-4'>\r\n                    <span>Page {page} of {totalPages}</span>\r\n                    <button onClick={() => setPage(page - 1)} disabled={page === 1}>\r\n                        Font\r\n                    </button>\r\n                    <button onClick={() => setPage(page + 1)} disabled={page === totalPages}>Next</button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default HistoryPage;\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 571, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}